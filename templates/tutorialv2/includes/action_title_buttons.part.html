{% load i18n %}
{% load target_tree %}
{% load times %}

<div class="actions-title">
    <a href="{{ child.get_edit_url }}" class="ico-after edit btn btn-grey">
        {% trans "Éditer" %}
    </a>
    <a href="#move-{{ child.slug }}" class="open-modal ico-after move btn btn-grey simple-move-button">{% trans "Déplacer" %}</a>
    <form action="{% url "content:move-element" %}" method="post" class="modal modal-flex" id="move-{{ child.slug }}">
        <select name="moving_method">
            <option disabled="disabled">{% trans "Déplacer" %}</option>
            {% if child.position_in_parent > 1 %}
                <option value="up">{% trans "Monter" %}</option>
            {% endif %}

            {% if child.position_in_parent < child.parent.children|length %}
                <option value="down">{% trans "Descendre" %}</option>
            {% endif %}
            <option disabled="disabled">&mdash; {% trans "Déplacer avant" %}</option>
            {% for element in child|target_tree %}
                    <option value="before:{{element.0}}"
                    {% if not element.3 %} disabled {% endif %}>
                         &mdash;&mdash;{% for _ in element.2|times %}&mdash;{% endfor %}{{ element.1|truncatechars:50 }}
                    </option>
            {% endfor %}
            <option disabled="disabled">&mdash; {% trans "Déplacer après" %}</option>
            {% for element in child|target_tree %}
                    <option value="after:{{element.0}}"
                    {% if not element.3 %} disabled {% endif %}>
                         &mdash;&mdash;{% for _ in element.2|times %}&mdash;{% endfor %}{{ element.1|truncatechars:50 }}
                    </option>
            {% endfor %}
        </select>
        <input type="hidden" name="child_slug" value="{{ child.slug }}">
        {% if child.text %}
            <input type="hidden" name="container_slug" value="{{ child.container.slug }}">
            <input type="hidden" name="first_level_slug" value="{{ child.get_first_level_slug }}">
        {%  else %}
            <input type="hidden" name="container_slug" value="{{ child.parent.slug }}">
        {% endif %}

        <input type="hidden" name="pk" value="{{ content.pk }}">
        {% csrf_token %}
        <button type="submit">
            {% trans "Déplacer" %}
        </button>
    </form>
    {% include "tutorialv2/includes/delete.part.html" with object=child additional_classes="ico-after cross btn btn-grey" %}
</div>