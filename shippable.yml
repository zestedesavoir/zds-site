build_environment: ubuntu1204
git:
  depth: 1
language: python
python:
  - "2.7"
install:
  - "sudo apt-get update"
  - "sudo mkdir -p ~/cabal/bin"
  - "sudo mkdir -p ~/.pandoc"
  # install tex libs
  - "sudo apt-get install texlive texlive-xetex texlive-lang-french texlive-latex-extra texlive-latex-extra"
  # download pandoc for 12.04 and default fonts
  - "sudo wget -P ~/cabal/bin https://dl.dropboxusercontent.com/u/18967337/pandoc"
  - "sudo chmod u+x,g+x,o+x ~/cabal/bin/pandoc"
  - "sudo wget -P ~/.pandoc/templates https://dl.dropboxusercontent.com/u/14517385/dev/default.epub"
  - "sudo wget -P ~/.pandoc/templates https://dl.dropboxusercontent.com/u/14517385/dev/default.html"
  - "sudo touch ~/.pandoc/epub.css"
  - "sudo touch ~/.pandoc/templates/epub.css"
  - "export PATH=~/cabal/bin:$PATH"
  - "sudo ln -s ~/cabal/bin/pandoc /usr/bin/pandoc"
  - "pandoc --version"
  # download fonts Verdana and Andale Mono
  - "sudo wget -P /usr/share/fonts/truetype/msttcorefonts https://www.dropbox.com/s/yop3h76n7p3mpsi/Verdana.ttf?dl=1"
  - "sudo wget -P /usr/share/fonts/truetype/msttcorefonts https://www.dropbox.com/s/teds83czkfytl1p/Andale_Mono.ttf?dl=1"
  # install fr langage pack
  - "sudo apt-get --reinstall install -qq language-pack-fr"
  - "pip install -r requirements.txt --use-mirrors"
  - "pip install coveralls"
  - "npm install -g bower gulp"
  - "npm install"
script:
  - npm run-script travis
  - coverage run --source='.' manage.py test
after_success:
  - coveralls
